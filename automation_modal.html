<!-- Modal per la configurazione delle automazioni -->
<div class="modal fade" id="automationModal" tabindex="-1" aria-labelledby="automationModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="automationModalLabel">Configura Automazione</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="automation-form">
                    <!-- Step 1: Informazioni generali -->
                    <div class="automation-step" id="step-general">
                        <h6 class="border-bottom pb-2 mb-3">Informazioni Generali</h6>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="automation-name" class="form-label">Nome Automazione</label>
                                <input type="text" class="form-control" id="automation-name" required>
                            </div>
                            <div class="col-md-6">
                                <label for="automation-type" class="form-label">Tipo di Automazione</label>
                                <select class="form-select" id="automation-type" required>
                                    <option value="" selected disabled>Seleziona un tipo...</option>
                                    <option value="profile_scraper">Profile Scraper</option>
                                    <option value="auto_connect">AutoConnect</option>
                                    <option value="auto_message">AutoMessage</option>
                                    <option value="post_extractor">Post Extractor</option>
                                    <option value="company_scraper">Company Scraper</option>
                                    <option value="job_crawler">Job Crawler</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="automation-platform" class="form-label">Piattaforma</label>
                                <select class="form-select" id="automation-platform" required>
                                    <option value="" selected disabled>Seleziona una piattaforma...</option>
                                    <option value="linkedin">LinkedIn</option>
                                    <option value="facebook">Facebook</option>
                                    <option value="instagram">Instagram</option>
                                    <option value="twitter">Twitter</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="automation-schedule" class="form-label">Pianificazione</label>
                                <select class="form-select" id="automation-schedule">
                                    <option value="once">Una volta sola</option>
                                    <option value="daily">Giornaliera</option>
                                    <option value="weekly">Settimanale</option>
                                    <option value="monthly">Mensile</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-12">
                                <label for="automation-description" class="form-label">Descrizione</label>
                                <textarea class="form-control" id="automation-description" rows="2"></textarea>
                            </div>
                        </div>
                        <div class="d-flex justify-content-end">
                            <button type="button" class="btn btn-primary next-step">Avanti</button>
                        </div>
                    </div>
                    
                    <!-- Step 2: Configurazione specifica per tipo -->
                    <div class="automation-step d-none" id="step-specific">
                        <!-- Profile Scraper -->
                        <div class="type-config d-none" id="config-profile_scraper">
                            <h6 class="border-bottom pb-2 mb-3">Configurazione Profile Scraper</h6>
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label for="profile-keywords" class="form-label">Parole chiave</label>
                                    <input type="text" class="form-control" id="profile-keywords" placeholder="Es. Marketing Manager, CEO">
                                </div>
                                <div class="col-md-6">
                                    <label for="profile-location" class="form-label">Località</label>
                                    <input type="text" class="form-control" id="profile-location" placeholder="Es. Milano, Italia">
                                </div>
                            </div>
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label for="profile-industry" class="form-label">Settore</label>
                                    <select class="form-select" id="profile-industry">
                                        <option value="">Qualsiasi settore</option>
                                        <option value="information-technology">Information Technology</option>
                                        <option value="manufacturing">Manifattura</option>
                                        <option value="services">Servizi</option>
                                        <option value="retail">Commercio</option>
                                        <option value="construction">Edilizia</option>
                                        <option value="agriculture">Agricoltura</option>
                                        <option value="tourism">Turismo</option>
                                        <option value="energy">Energia</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label for="profile-company-size" class="form-label">Dimensione azienda</label>
                                    <select class="form-select" id="profile-company-size">
                                        <option value="">Qualsiasi dimensione</option>
                                        <option value="1-10">1-10 dipendenti</option>
                                        <option value="11-50">11-50 dipendenti</option>
                                        <option value="51-200">51-200 dipendenti</option>
                                        <option value="201-500">201-500 dipendenti</option>
                                        <option value="501-1000">501-1000 dipendenti</option>
                                        <option value="1001+">1001+ dipendenti</option>
                                    </select>
                                </div>
                            </div>
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label for="profile-limit" class="form-label">Numero massimo di profili</label>
                                    <input type="number" class="form-control" id="profile-limit" value="100" min="1" max="500">
                                </div>
                                <div class="col-md-6">
                                    <label for="profile-data-fields" class="form-label">Campi da estrarre</label>
                                    <select class="form-select" id="profile-data-fields" multiple>
                                        <option value="name" selected>Nome</option>
                                        <option value="headline" selected>Headline</option>
                                        <option value="company" selected>Azienda</option>
                                        <option value="location" selected>Località</option>
                                        <option value="email">Email</option>
                                        <option value="phone">Telefono</option>
                                        <option value="website">Sito web</option>
                                        <option value="experience">Esperienze</option>
                                        <option value="education">Formazione</option>
                                        <option value="skills">Competenze</option>
                                    </select>
                                    <div class="form-text">Tieni premuto Ctrl per selezionare più campi</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- AutoConnect -->
                        <div class="type-config d-none" id="config-auto_connect">
                            <h6 class="border-bottom pb-2 mb-3">Configurazione AutoConnect</h6>
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label for="connect-search-criteria" class="form-label">Criteri di ricerca</label>
                                    <input type="text" class="form-control" id="connect-search-criteria" placeholder="Es. CEO PMI Milano">
                                </div>
                                <div class="col-md-6">
                                    <label for="connect-limit" class="form-label">Numero massimo di inviti</label>
                                    <input type="number" class="form-control" id="connect-limit" value="20" min="1" max="100">
                                    <div class="form-text">LinkedIn limita a 100 inviti alla settimana</div>
                                </div>
                            </div>
                            <div class="row mb-3">
                                <div class="col-md-12">
                                    <label for="connect-message" class="form-label">Messaggio personalizzato</label>
                                    <textarea class="form-control" id="connect-message" rows="3" placeholder="Ciao {{name}}, vorrei connettermi con te perché..."></textarea>
                                    <div class="form-text">Usa {{name}} per inserire il nome del destinatario</div>
                                </div>
                            </div>
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label for="connect-daily-limit" class="form-label">Limite giornaliero</label>
                                    <input type="number" class="form-control" id="connect-daily-limit" value="10" min="1" max="30">
                                </div>
                                <div class="col-md-6">
                                    <label for="connect-delay" class="form-label">Ritardo tra inviti (secondi)</label>
                                    <input type="number" class="form-control" id="connect-delay" value="60" min="30" max="300">
                                </div>
                            </div>
                        </div>
                        
                        <!-- Altri tipi di configurazione seguono lo stesso pattern -->
                        <!-- AutoMessage, Post Extractor, Company Scraper, Job Crawler -->
                        
                        <div class="d-flex justify-content-between">
                            <button type="button" class="btn btn-secondary prev-step">Indietro</button>
                            <button type="button" class="btn btn-primary next-step">Avanti</button>
                        </div>
                    </div>
                    
                    <!-- Step 3: Opzioni di esportazione -->
                    <div class="automation-step d-none" id="step-export">
                        <h6 class="border-bottom pb-2 mb-3">Opzioni di Esportazione</h6>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="export-format" class="form-label">Formato di esportazione</label>
                                <select class="form-select" id="export-format">
                                    <option value="csv" selected>CSV</option>
                                    <option value="json">JSON</option>
                                    <option value="google-sheets">Google Sheets</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="export-filename" class="form-label">Nome file</label>
                                <input type="text" class="form-control" id="export-filename" placeholder="nome_file">
                                <div class="form-text">Senza estensione</div>
                            </div>
                        </div>
                        
                        <!-- Opzioni specifiche per Google Sheets -->
                        <div class="row mb-3 d-none" id="google-sheets-options">
                            <div class="col-md-12">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="create-new-sheet" checked>
                                    <label class="form-check-label" for="create-new-sheet">
                                        Crea un nuovo foglio
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-12 mt-2 d-none" id="existing-sheet-container">
                                <label for="existing-sheet-id" class="form-label">ID foglio esistente</label>
                                <input type="text" class="form-control" id="existing-sheet-id" placeholder="ID del foglio Google Sheets">
                                <div class="form-text">L'ID si trova nell'URL del foglio</div>
                            </div>
                        </div>
                        
                        <div class="row mb-3">
                            <div class="col-md-12">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="export-auto-download" checked>
                                    <label class="form-check-label" for="export-auto-download">
                                        Scarica automaticamente i risultati
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mb-3">
                            <div class="col-md-12">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="export-notify" checked>
                                    <label class="form-check-label" for="export-notify">
                                        Notifica al completamento
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="d-flex justify-content-between">
                            <button type="button" class="btn btn-secondary prev-step">Indietro</button>
                            <button type="button" class="btn btn-success" id="save-automation">Salva Automazione</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Modal per la visualizzazione dei risultati -->
<div class="modal fade" id="resultsModal" tabindex="-1" aria-labelledby="resultsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="resultsModalLabel">Risultati Automazione</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="row mb-3">
                    <div class="col-md-6">
                        <h6 id="results-automation-name">Nome Automazione</h6>
                    </div>
                    <div class="col-md-6 text-end">
                        <div class="btn-group">
                            <button type="button" class="btn btn-sm btn-outline-secondary" id="export-results-csv">Esporta CSV</button>
                            <button type="button" class="btn btn-sm btn-outline-secondary" id="export-results-json">Esporta JSON</button>
                            <button type="button" class="btn btn-sm btn-outline-secondary" id="export-results-sheets">Esporta su Sheets</button>
                        </div>
                    </div>
                </div>
                
                <div class="table-responsive">
                    <table class="table table-striped" id="results-table">
                        <thead>
                            <!-- Le intestazioni verranno generate dinamicamente -->
                        </thead>
                        <tbody>
                            <!-- I risultati verranno inseriti qui dinamicamente -->
                        </tbody>
                    </table>
                </div>
                
                <div class="row mt-3">
                    <div class="col-md-6">
                        <p><strong>Totale risultati:</strong> <span id="results-count">0</span></p>
                    </div>
                    <div class="col-md-6 text-end">
                        <p><strong>Ultima esecuzione:</strong> <span id="results-last-run">-</span></p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Chiudi</button>
            </div>
        </div>
    </div>
</div>
